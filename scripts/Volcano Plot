%%R
library(ggplot2)

volcano_df <- as.data.frame(res)
volcano_df$gene <- rownames(volcano_df)
volcano_df$significant <- volcano_df$padj < 0.05

ggplot(volcano_df, aes(x = log2FoldChange, y = -log10(padj))) +
  geom_point(aes(color = significant), alpha = 0.6, size = 1.2) +
  scale_color_manual(values = c("grey", "blue")) +
  coord_cartesian(xlim = c(-10, 10), ylim = c(0, 10)) +
  theme_bw() +
  labs(x = "Log2 Fold Change",
       y = "-Log10 Adjusted p-value")
